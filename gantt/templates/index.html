{% load static %}
<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="https://cdn.tailwindcss.com"></script>

    <title>Home</title>
</head>

<body>
    <nav class="navbar-default navbar navbar-expand-lg navbar-dark bg-dark bg-myblack">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto w-100 mb-2 mb-lg-0 d-flex justify-content-around text-light">
                    <li class="" style="opacity: 70%">
                        <a class="nav_link active" aria-current="page" href="#">Acceuil</a>
                    </li>
                    <li class="">
                        <a class="nav_link" href="#presentation">Présentation</a>
                    </li>
                    <li class="">
                        <a class="nav_link" href="#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="hero-image flex justify-center items-center">
        <div class="hero-text text-gray-950">
            <h1 class="h1">Plannifie ton projet</h1>
            <h3 class="h3">En réalisant un diagramme de <strong>GANTT</strong></h3>
            <button
                class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-brown py-2 px-4 border border-blue-500 hover:border-transparent rounded"><a
                    href="#main-content">Commencer</a></button>
        </div>
    </div>

    <main class="container">
        <section class="presentation container" id="presentation">
            <h1 class="h1">C'est quoi un diagramme de <strong>GANTT</strong>?</h1>
            <div class="text-justify">
                <p>Le diagramme de <strong>Gantt</strong>, couramment utilisé en gestion de
                    projet, est l'un des
                    outils les plus
                    efficaces
                    pour
                    représenter visuellement l'état d'avancement des différentes activités (tâches) qui constituent un
                    projet.
                    La colonne de gauche du diagramme énumère toutes les tâches à effectuer, tandis que la ligne
                    d'en-tête
                    représente les unités de temps les plus adaptées au projet (jours, semaines, mois etc.). Chaque
                    tâche
                    est
                    matérialisée par une barre horizontale, dont la position et la longueur représentent la date de
                    début,
                    la
                    durée et la date de fin. Ce diagramme permet donc d'identifier rapidement: la date de début et la
                    date de fin de chaque tâche,
                    la durée escomptée de chaque tâche, le chevauchement éventuel des tâches, et la durée de ce
                    chevauchement
                    La date de début et la date de fin du projet dans son ensemble.</p>
                <!-- <div class="image"></div> -->
                
            </div>

        </section>

        <section class="presentation my-3 container">
            <div class="grid md:grid-cols-2 md:gap-20">
                <div>
                    <h1 class="h1">Créer votre diagramme de <strong>GANTT</strong></h1>
                    <div class="text-justify">
                        <p>Le fichier excel à importer devra contenir 4 colonnes: la
                            première le code de la tâche, la deuxième
                            le libele de la tâche, la troisième la durée de chaque tâche et la dernière les précédences de
                            chacune des tâches. De la même façon que vous pouvez le voir ci-dessous</p>
                        <a href="{% static 'modele_gantt.xlsx' %}">
                            <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center mt-4">
                                <svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/></svg>
                                <span>Telecharger le modèle excel</span>
                            </button>
                        </a>
                        {% comment %} <img src="{% static 'images/example-file.png' %}" width="100%" /> {% endcomment %}
                    </div>
                </div>
                <div class="w-10/12" id="main-content">
                    <div class="uploader">
                        <form method="post" action="#result" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="file-upload">
                                <label for="unit">Unité de la durée d'une tâche</label>
                                <select class="form-select mb-3" name="unit">
                                    <option value="1">Jour</option>
                                    <option value="2">Mois</option>
                                    <option value="3">Année</option>
                                </select>
                                <label for="start">Date de début:</label>

                                <input class="w-full text-sm text-gray-900 border border-gray-300 rounded cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 p-2" type="date" id="start" name="date">
                            </div>

                            <script class="jsbin"
                                src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
                            <div class="file-upload">

                                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white "
                                    for="file_input">Upload file</label>
                                <input
                                    class="block w-full text-sm text-gray-900 border border-gray-300 rounded cursor-pointer bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400"
                                    aria-describedby="file_input_help" id="file_input" type="file" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" name='tasks' required>
                                <p class="mt-1 text-sm text-gray-500 dark:text-gray-300" id="file_input_help">XLSX file.</p>
                                
                                <button type="submit"
                                    class="py-2.5 px-3 me-2 my-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:text-[#8c5d49] hover:bg-[#8c5d49]">Générer</button>

                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </section>
        {% if print_diagram %}
        <section class="text-danger h1" id="result">
            {{ message }}
            <span class="text-dark">Pour plus de détail bien vouloir consulter le diagramme et le tableau
                ci-après</span>
        </section>
        <canvas id="myChart" width="400" height="400"></canvas>
        <table class="table table-striped caption-top">
            <caption>Récapitulatif</caption>
            <thead>
                <tr>
                    <th scope="col">tache</th>
                    <th scope="col">Date de début</th>
                    <th scope="col">Date de fin</th>
                </tr>
            </thead>
            <tbody>
                {% for label, debut, fin in intervales_date %}
                <tr>
                    <td>{{ label }}</td>
                    <td>{{ debut }}</td>
                    <td>{{ fin }}</td>
                </tr>

                {% endfor %}

            </tbody>
        </table>
        {% endif %}


    </main>
    <footer id="contact">
        <p>Email : <a href="mailto:kamganguifo@gmail.com"></a>kamganguifo@gmail.com</p>
        <p>Téléphone : <a href="tel:+237 655303793"></a>+237 655303793</p>
        <p>Github : <a class="text-primary" href="https://github.com/kndbvortex">https://github.com/kndbvortex</a></p>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.8.2/dist/chart.min.js"
        integrity="sha256-srZ7wC4CLlY0F9UFji68dTwYJQ5o93Quq2+iyQ4gH/I=" crossorigin="anonymous"></script>
    <script>
        {% comment %} console.log({{ intervales| safe}}.map((e) => [new Date(e[0]), new Date(e[1])])) {% endcomment %}
        {% if print_diagram %}
        const data = {
            labels: {{ labels| safe}},
        datasets: [
            {
                label: 'Chemin critique',
                data: {{ intervales| safe}},
            backgroundColor: {{ couleurs| safe}},
                    },

        ]
            };
        const config = {
            type: 'bar',
            data: data,
            options: {
                indexAxis: 'y',
                // Elements options apply to all of the options unless overridden in a dataset
                // In this case, we are setting the border of each horizontal bar to be 2px wide
                elements: {
                    bar: {
                        borderWidth: 2,
                    }
                },
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                    },
                    title: {
                        display: true,
                        text: 'Diagramme de Gantt'
                    }
                }
            },
        };
        const myChart = new Chart(
            document.getElementById('myChart'),
            config
        );
        {% endif %}

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/datepicker.min.js"></script>


</body>

</html>